@page "/galleryDecade/edit/{decadeId:int}"

@layout AdminLayout

@inject IHttpContextAccessor httpContext
@inject IGalleryRepository galleryRepository
@inject NavigationManager navManager
@attribute [Authorize(Roles = "Admin")]

<div class="row">
    <div class="col-4">
        <HeadingC Text="Update Gallery Decade" />

        <EditForm Model="@Decade" OnValidSubmit="UpdateDecade">
            <DataAnnotationsValidator />

            <div class="row mt-3">
                <div class="col">
                    <div class="form-group">
                        <label>Decade</label>
                        <div>
                            <InputText @bind-Value="@Decade.Decade" class="form-control" />
                            <ValidationMessage For="() => Decade.Decade"></ValidationMessage>
                        </div>
                    </div>

                    <div class="mt-3 text-center">
                        <button type="submit" class="btnUpdate">
                            Update Decade
                        </button>
                        <a href="galleryDecades" class="btnReturn ms-3">Return</a>
                    </div>
                </div>
            </div>
        </EditForm>
    </div>
</div>

@code {
    [Parameter] public int DecadeId { get; set; }
    GalleryDecadeDTO Decade = new GalleryDecadeDTO();

    protected override async Task OnParametersSetAsync()
    {
        var tDecade = await galleryRepository.GetDecade(DecadeId);
        Decade = tDecade;
    }

    private async Task UpdateDecade()
    {
        var addResult = await galleryRepository.UpdateDecade(Decade);
        navManager.NavigateTo("galleryDecades");
    }

}
